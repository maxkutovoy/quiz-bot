# Чат-бот викторина для Вконтакте и Телеграм.

Чат-бот для Вконтакте и Телеграм присылает вопрос, и проверяет ответ. 
Для начала викторины с телеграм-ботом необходимо написать команду `/start`, 
с ботом Вконтакте любое сообщение, например `'Привет'`. После этого нажать кнопку
`'Новый вопрос'`

Если угадать ответ не получается можно нажать `'Сдаться'`, тогда бот пришлет 
правильный ответ и новый вопрос. 

Проверить работу бота можно написав сообщение в группе [Вконтакте](https://vk.com/club208544402) или [Телеграм](https://t.me/botforexperimetsbot) 

## Как установить:

Скачать все файлы на свой компьютер.

### Установить зависимости:

Python3 должен быть уже установлен. Далее использовать `pip` (или `pip3`, есть конфликт с python2) для установки
зависимостей:

```
pip install -r requirements.txt
```

## Как использовать:

Для работы сервиса необходимо:
 - Создать базу данных [Redis](https://redislabs.com/). Получить адрес базы данных,
порт и пароль.
 - Создать файл `.env` в корневом каталоге проекта и прописать в нем настройки 
в формате `КЛЮЧ='ЗНАЧЕНИЕ'`.

Необходимые настройки:

- `TG_TOKEN` - токен телеграм-бота.
- `TG_CHAT_ID` - `chat_id` на который будут отправляться уведомления. Чтобы узнать свой
  `chat_id` можно написать боту `@userinfobot`.
- `VK_TOKEN` - токен от Вконтакте.
- `REDIS_DB_NAME` - адрес базы данных Redis вида `redis-12312.f18.us-east-4-9.wc1.cloud.redislabs.com`.
- `REDIS_PORT` - порт базы данных Redis.
Порт часто пишется прямо в адресе, через двоеточие: `redis-12312.f18.us-east-4-9.wc1.cloud.redislabs.com:16635`.
- `REDIS_PASSWORD` - пароль от базы данных Redis.

### Для запуска Телеграм бота введите команду:

```sh
python tg_bot.py
```

### Для запуска бота Вконтакте введите команду:

```sh
python vk_bot.py
```

ВНИМАНИЕ! Для запуска ботов одновременно вводите команды в разных терминалах.

## Добавить новые вопросы в викторину:

В викторину можно добавить новые вопросы. Для этого необходимо создать текстовый 
файл и прописать в нем новые вопросы и ответы в формате: 

```txt
Вопрос 1:
Тескт первого вопроса.

Ответ:
Текст первого ответа


Вопрос 2:
Текст воторого вопроса

Ответ:
Текст второго ответа
```
 - Новый вопрос должен начитаться со слова `Вопрос:`.
 - Текст вопроса с новой строки.
 - Перед ответом пустая строка.
 - Ответ должен начитаться со слова `Ответ:`
 - Текст ответа с новой строки.
 - Перед новым вопросом 2 пустые строки.

После этого запустить команду:
```sh
python parse_questions.py
```

Команда принимает 2 необязательных параметра:
 - `--path_to_file` - путь до файла с вопросами. По умолчанию указан файл в 
корневом каталоге проекта `questions.txt`. Новые вопросы можно добавлять в этот
файл, тогда при добавлении новых вопросов в базу данных параметр `--path_to_file`
указывать необязательно.
 - `--encoding` - кодировка файла. По умолчанию указана кодировка `UTF-8`.  
ВНИМАНИЕ! Тестовый файл с вопросами `questions.txt` имеет кодировку `KOI8-R`,
поэтому при добавлении новых вопросов из этого файла необходимо указывать параметр 
`--encoding 'KOI8-R'`.

```sh
python parse_questions.py --encoding 'KOI8-R'
```

## Цель проекта:

Код написан в образовательных целях на курсе для web-разработчиков [dvmn.org](https://dvmn.org/).
